plot(e.data.mds,type="t",main="NMDS Sage Data")
plot(fit.sage,col="chartreuse4", cex=0.7)
stems <- colSums(data)
stems
plot(data)
plot(data)
plot(e.data.mds)
plot(e.data.mds, disp="sp",type="n")
sel <- orditorp(e.data.mds, dis="sp", priority=stems,pcol="gray",pch="+")
is.data.frame(data)
length(which(data != "NA"))
pl <- plot(e.data.mds,dis="sp")
identify(pl,"sp")
plot(e.data.mds,type="t",main="NMDS % ARTR.D/All Shrubs Data")
ordiplot(e.data.mds, display ="species", type ="n")
text(e.data.mds, display="species", col="red", cex=0.7)
pl <- plot(e.data.mds,dis="sp")
identify(pl,"sp")
pl <- plot(e.data.mds,dis="sp")
identify(pl,"sp")
ordiplot(e.data.mds, display ="species", type ="n")
text(e.data.mds, display="sites", col="black", cex=0.7)
text(e.data.mds, display="species", col="red", cex=0.7)
ordiplot(b.data.mds, display ="species", type ="n")
text(b.data.mds, display="sites", col="black", cex=0.7)
text(b.data.mds, display="species", col="red", cex=0.7)
plot(e.data.mds,type="t",main="NMDS Soil Data")
plot(sig.fit.env,col="blue", cex=0.7)
fit.env <- envfit(b.data.mds,data.env,perm=1000)
fit.env
View(data.env)
sig.data.env<-data.env[,c(5,7,9,12,15:17,19:25,28:29,)]
sig.data.env<-data.env[,c(5,7,9,12,15:17,19:25,28:29,)]
sig.data.env<-data.env[,c(5,7,9,12,15:17,19:25,28:29)]
sig.fit.env<-envfit(e.data.mds,sig.data.env,perm=1000)
sig.fit.env # Check that you pulled up the right factors.
fit.env <- envfit(b.data.mds,data.env,perm=1000)
fit.env
sig.data.env<-data.env[,c(5,7,9,12,15:17,19:25,28:29)]
sig.fit.env<-envfit(e.data.mds,sig.data.env,perm=1000)
sig.fit.env # Check that you pulled up the right factors.
plot(b.data.mds,type="t",main="NMDS Soil Data")
plot(sig.fit.env,col="blue", cex=0.7)
ordiplot(b.data.mds, display ="species", type ="n")
text(b.data.mds, display="sites",type="p", col="black", cex=0.7)
text(b.data.mds, display="species", col="red", cex=0.7)
ordiplot(b.data.mds, display ="species", type ="n")
text(b.data.mds, display="species", col="red", cex=0.7)
fit.env <- envfit(b.data.mds,data.env,perm=1000)
fit.env
sig.data.env<-data.env[,c(5,7,9,12,15:17,19:25,28:29)]
sig.fit.env<-envfit(e.data.mds,sig.data.env,perm=1000)
sig.fit.env # Check that you pulled up the right factors.
plot(b.data.mds,type="t",main="NMDS Soil Data")
plot(sig.fit.env,col="blue", cex=0.7)
ordiplot(b.data.mds, display ="species", type ="n")
text(b.data.mds, display="sites",type="p", col="black", cex=0.7)
text(b.data.mds, display="species", col="purple", cex=0.7)
fit.env <- envfit(b.data.mds,data.env,perm=1000)
fit.env
sig.data.env<-data.env[,c(5,7,9,12,15:17,19:25,28:29)]
sig.fit.env<-envfit(e.data.mds,sig.data.env,perm=1000)
sig.fit.env # Check that you pulled up the right factors.
plot(b.data.mds,type="t",main="NMDS Soil Data")
plot(sig.fit.env,col="blue", cex=0.7)
ordiplot(b.data.mds, display ="species", type ="n")
text(b.data.mds, display="sites",type="p", col="black", cex=0.7)
text(b.data.mds, display="species", col="red", cex=0.7)
ordiplot(b.data.mds, display ="species", type ="n")
text(b.data.mds, display="species", col="red", cex=0.7)
p<-ordiplot(b.data.mds, display ="species", type ="n")
p<-text(b.data.mds, display="species", col="red", cex=0.7)
plot(p,type="t",main="NMDS Soil Data")
plot(sig.fit.env,col="blue", cex=0.7)
p<-ordiplot(b.data.mds, display ="species", type ="n")
text(b.data.mds, display="species", col="red", cex=0.7)
plot(p,type="t",main="NMDS Soil Data")
plot(sig.fit.env,col="blue", cex=0.7)
plot(e.data.mds, type="n")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="yellow")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(e.data.mds, type="n")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
fit.env <- envfit(e.data.mds,data.env,perm=1000)
sig.data.env<-data.env[,c(8:9,12,16,17,24)]
sig.fit.env<-envfit(e.data.mds,sig.data.env,perm=1000)
sig.fit.env # Check that you pulled up the right factors.
plot(e.data.mds, type="n")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(e.data.mds,type="t",main="NMDS Soil Data")
plot(sig.fit.env,col="blue", cex=0.7)
plot(e.data.mds, type="n")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="blue", cex=0.7)
plot(e.data.mds, type="n",main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=-1.5,ylim=1.5,main="NMDS Soil Data")
plot(e.data.mds, type="n",xlim=-1,ylim=1,main="NMDS Soil Data")
stems <- colSums(data)
plot(e.data.mds, disp="sp",type="n")
sel <- orditorp(e.data.mds, dis="sp", priority=stems,pcol="gray",pch="+")
plot(e.data.mds, type="n",xlim=c(-1.5,1.5),ylim=c(-1,0.3),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(0,10),ylim=c(0,10),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(e.data.mds, type="n",xlim=c(-2,2),ylim=c(-1,0.5),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(-1.5,2),ylim=c(-1,0.5),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="black")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(-1.5,2),ylim=c(-1,0.5),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="white")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(-1.5,2),ylim=c(-1,0.5),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.8,pch=21,col="red", bg="red")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(-1.5,2),ylim=c(-1,0.5),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.5,pch=21,col="red", bg="red")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(-1.5,2),ylim=c(-1,0.5),main="NMDS Soil Data",bg="gray")
points(e.data.mds,display="sites",cex=0.5,pch=21,col="red", bg="red")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(-1.5,2),ylim=c(-1,0.5),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.5,pch=21,col="red", bg="red")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7)
plot(e.data.mds, type="n",xlim=c(-1.5,2),ylim=c(-1,0.5),main="NMDS Soil Data")
points(e.data.mds,display="sites",cex=0.5,pch=21,col="red", bg="red")
text(e.data.mds,display="species", cex=0.7, col="blue")
plot(sig.fit.env,col="green4", cex=0.7,font=2)
library(plyr)
class <- read.csv('F:/ShrubDensity/HeightClass/PlantDenDetail 8-21.csv')
class$total <- rowSums(class[,4:8]) #Sum all size classes for total density
total <- class[, c(1,2,3,9)] # Just total, size class removed
TotalplotXspp<-xtabs(total~Plot+SpeciesCode, total) # put in plot by spp matrix
TotaldensityM2 <- TotalplotXspp/180 # density per M2
write.csv(TotaldensityM2,file="F:/ShrubDensity/HeightClass/USGSTotalDensityM2.csv")
TotalDen <- read.csv("F:/ShrubDensity/HeightClass/USGSTotalDensityM2.csv",row.names=1)
TotalDen <- TotalDen[,c(8:9)]
TotalDen$L.D.DenM2 <- (TotalDen$ARTR2 + TotalDen$ARTR2.D)
View(TotalDen)
TotalDen$L.DenM2 <- TotalDen$ARTR2
Sage.Env.USGS <- TotalDen[,c(3:4)]
View(Sage.Env.USGS)
TotalplotXspp<-xtabs(total~Plot+SpeciesCode, total) # put in plot by spp matrix
write.csv(TotalplotXspp,file="F:/ShrubDensity/HeightClass/USGSTotalplotXspp.csv")
Total <- read.csv("F:/ShrubDensity/HeightClass/USGSTotalplotXspp.csv",row.names=1)
View(Total)
lpi <- read.csv("F:/LPI/USGSLPIRelativeCoverCommonInExcel.csv")
lpi <- lpi[-c(160:162),] # remove SUMS and COUNTIF rows at the bottom
row.names(lpi)<-lpi$X
View(lpi)
lpi <- read.csv("F:/LPI/USGSLPIRelativeCoverCommonInExcel.csv")
View(lpi)
lpi <- lpi[-c(160:162),] # remove SUMS and COUNTIF rows at the bottom
row.names(lpi)<-lpi$X
lpi <- lpi[,-1] # remove extra plot id column
View(lpi)
lpi.l.relcov <- ((lpi$ARTR2)/rowSums(lpi))*100
# Code for #6
lpi.l.d.relcov <- ((lpi$ARTR2 + lpi$ARTR2.D)/rowSums(lpi))*100
# Combine for #4
Sage.Env.USGS$L.PropCov <- lpi.l.relcov/lpi.l.d.relcov
# 5
# Sage relative cover (live+dead)
# add all points of a spp. in a plot, then sum ARTR2 and ARTR2.D. Next divide by the total number of individuals of all species.
Sage.Env.USGS$L.D.RelCov <- ((Total$ARTR2 + Total$ARTR2.D)/rowSums(Total))*100
# 6
# Sage relative cover (live)
# add all points of a spp. in a plot, then take only ARTR2 and  divide by the total number of individuals of all species.
Sage.Env.USGS$L.RelCov <- ((Total$ARTR2)/rowSums(Total))*100
# 7
# Perrenial Grass relative cover
View(lpi)
View(Sage.Env.USGS)
Sage.Env.USGS$PG.RelCov <- (lpi$ACHY+lpi$ARPU9+lpi$BOGR2+lpi$BOGR2.D+lpi$ELEL+lpi$HECO26+lpi$HECO26.D+lpi$SPCR+lpi$SPCR.D+lpi$HIJA)
#######################################################################
# Remove USGS, only April Data
# Do oridnation with soil properties, then put on the veg vecotrs to see
# how they relate to the properties.
# veg vectors:
# 1   Sage density (live+dead)
# 2   Sage density (live)
# 3   Proportion Sage individuals alive (talk to Susan about how to deal with sage absences)
# 4   Proportion Sage cover alive
# 5   Sage relative cover (live+dead)
# 6   Sage relative cover (live)
# 7   Perrenial Grass ralative cover
library(plyr)
# 1
# Sage density (live+dead)
# know area sampled: 30m transects X 2m belt X 3 transects per plot
# (2,3,& 4) = 180m2. Density in m2
# Total number of a spp. in a plot divided by the number of meters sampled in a plot(180m for shrub transects)
# Then add ARTR2 and ARTR2.D
class <- read.csv('F:/ShrubDensity/HeightClass/PlantDenDetail 8-21.csv')
class$total <- rowSums(class[,4:8]) #Sum all size classes for total density
total <- class[, c(1,2,3,9)] # Just total, size class removed
TotalplotXspp<-xtabs(total~Plot+SpeciesCode, total) # put in plot by spp matrix
TotaldensityM2 <- TotalplotXspp/180 # density per M2
write.csv(TotaldensityM2,file="F:/ShrubDensity/HeightClass/USGSTotalDensityM2.csv")
TotalDen <- read.csv("F:/ShrubDensity/HeightClass/USGSTotalDensityM2.csv",row.names=1)
TotalDen <- TotalDen[,c(8:9)]
TotalDen$L.D.DenM2 <- (TotalDen$ARTR2 + TotalDen$ARTR2.D)
# 2
# Sage density (live)
# Total number of a spp. in a plot divided by the number of meters sampled in a plot(180m for shrub transects)
# Then choose only ARTR2
TotalDen$L.DenM2 <- TotalDen$ARTR2
Sage.Env.USGS <- TotalDen[,c(3:4)]
# 3
# Proportion Sage individuals alive (talk to Susan about how to deal with sage absences)
# (number of live individual sagebrush plants)/(number of live + number of dead individual sagebrush plants)
TotalplotXspp<-xtabs(total~Plot+SpeciesCode, total) # put in plot by spp matrix
write.csv(TotalplotXspp,file="F:/ShrubDensity/HeightClass/USGSTotalplotXspp.csv")
Total <- read.csv("F:/ShrubDensity/HeightClass/USGSTotalplotXspp.csv",row.names=1)
Sage.Env.USGS$L.PropIndM2 <- ((Total$ARTR2)/(Total$ARTR2+Total$ARTR2.D))
# 4
# Proportion Sage cover alive
# (SageRelativeCover(live))/(SageRelativeCover(live+dead))
lpi <- read.csv("F:/LPI/USGSLPIRelativeCoverCommonInExcel.csv")
lpi <- lpi[-c(160:162),] # remove SUMS and COUNTIF rows at the bottom
row.names(lpi)<-lpi$X
lpi <- lpi[,-1] # remove extra plot id column
lpi.l.relcov <- ((lpi$ARTR2)/rowSums(lpi))*100
# Code for #6
lpi.l.d.relcov <- ((lpi$ARTR2 + lpi$ARTR2.D)/rowSums(lpi))*100
# Combine for #4
Sage.Env.USGS$L.PropCov <- lpi.l.relcov/lpi.l.d.relcov
# 5
# Sage relative cover (live+dead)
# add all points of a spp. in a plot, then sum ARTR2 and ARTR2.D. Next divide by the total number of individuals of all species.
Sage.Env.USGS$L.D.RelCov <- ((Total$ARTR2 + Total$ARTR2.D)/rowSums(Total))*100
# 6
# Sage relative cover (live)
# add all points of a spp. in a plot, then take only ARTR2 and  divide by the total number of individuals of all species.
Sage.Env.USGS$L.RelCov <- ((Total$ARTR2)/rowSums(Total))*100
# 7
# Perrenial Grass relative cover
Sage.Env.USGS$PG.RelCov <- (lpi$ACHY+lpi$ARPU9+lpi$BOGR2+lpi$BOGR2.D+lpi$ELEL+lpi$HECO26+lpi$HECO26.D+lpi$SPCR+lpi$SPCR.D+lpi$HIJA)
#######################################################################
# Remove USGS, only April Data
Sage.Env.April <- Sage.Env.USGS[-c(1:60),] # remove usgs data
# Write USGS and April Data
write.csv(Sage.Env.April,file="F:/SageNMDSvariables/Sage.Env.April.csv")
write.csv(Sage.Env.USGS,file="F:/SageNMDSvariables/Sage.Env.USGS.csv")
################
# Choose only rows that have soils data
VegtoKeep <- Sage.Env.USGS[c("1","2","10","11","12","14","15","16","17","18","19","20","21","23","24","32","33","38","39","40","42","43","44","47","48","50","57","59","60","61","67","68","73","77","80","82","90"),]
# Add April data back in
Keep <- rbind(Sage.Env.April, VegtoKeep)
write.csv(Keep,file="F:/SageNMDSvariables/Sage.Env.USGS.csv")
####
# Choose 10 USGS plots in N&S plain
NS <- Sage.Env.USGS[c("19","24","33","39","43","44","47","48","50"),]
NSApril <- rbind(Sage.Env.April,NS)
write.csv(NSApril,file="F:/SageNMDSvariables/Sage.Env.NSplainApril.csv")
# NMDS on Selected Variables
## selected using Boruta and Random Forest Variable Importance Plots.
# read in data
All <- read.csv("F:/Soils/SoilEnvironmentalDataApril.csv",header=TRUE, row.names=1)
All[is.na(All)] <- 0 # replace NA with 0
All <- All[,c("H2_MinDryHue","H2_MinDryChroma","Depth100","Depth150","TotalDepth","AWC25","AWC50","AWC100")]
# add shrub environmental variables
sage.A <- read.csv("F:/SageNMDSvariables/Sage.Env.April.csv",header=TRUE,row.names=1)
sage.A[is.na(sage.A)] <- 0 # replace NA with 0
sage.H2 <- sage.A[-c(30,32,38,45,46,69),] #remove H2 empty rows.
All.ord<-metaMDS(comm=All,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
All.ord # k2=0.0018 ~0.2%
stressplot(All.ord)
fit.sage.A <- envfit(All.ord, sage.A,perm=1000)
fit.sage.A    #Sig = Den (l&ld), rel cov(l&ld)
All.ord<-metaMDS(comm=All,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
library(vegan)
library(MASS)
library(colorspace)
# read in data
All <- read.csv("F:/Soils/SoilEnvironmentalDataApril.csv",header=TRUE, row.names=1)
All[is.na(All)] <- 0 # replace NA with 0
All <- All[,c("H2_MinDryHue","H2_MinDryChroma","Depth100","Depth150","TotalDepth","AWC25","AWC50","AWC100")]
# add shrub environmental variables
sage.A <- read.csv("F:/SageNMDSvariables/Sage.Env.April.csv",header=TRUE,row.names=1)
sage.A[is.na(sage.A)] <- 0 # replace NA with 0
sage.H2 <- sage.A[-c(30,32,38,45,46,69),] #remove H2 empty rows.
All.ord<-metaMDS(comm=All,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
All.ord # k2=0.0018 ~0.2%
stressplot(All.ord)
fit.sage.A <- envfit(All.ord, sage.A,perm=1000)
fit.sage.A    #Sig = Den (l&ld), rel cov(l&ld)
sel <- readRDS("F:/SageNMDSvariables/sel.Rdata")
sel <- readRDS("F:/SageNMDSvariables/sel.Rdata")
plot(sel)
title(main = "NMDS Selected Soil Variables")
plot(fit.sage.A,col="blue", cex=0.9,font=2)
# read in data
All <- read.csv("F:/Soils/SoilEnvironmentalDataApril.csv",header=TRUE, row.names=1)
All[is.na(All)] <- 0 # replace NA with 0
# add shrub environmental variables
sage.A <- read.csv("F:/SageNMDSvariables/Sage.Env.April.csv",header=TRUE,row.names=1)
sage.A[is.na(sage.A)] <- 0 # replace NA with 0
sage.H2 <- sage.A[-c(30,32,38,45,46,69),] #remove H2 empty rows.
#
# All Soil Variables
#
All <- All[,c(1:40,42:43)] # remove SlopeShape (categorical)
All.ord<-metaMDS(comm=All,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
All.ord # k2=0.0285 ~3%
fit.sage.A <- envfit(All.ord, sage.A,perm=1000)
fit.sage.A    #Sig = Den (l&ld), rel cov(l&ld)
H1 <- All[,c(1:11)]
H1.ord<-metaMDS(comm=H1,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
H1.ord # k2=0.0265 ~3%
stressplot(H1.ord)
fit.sage.H1 <- envfit(H1.ord, sage.A,perm=1000)
fit.sage.H1    #Sig = Den (l&ld), prop ind, rel cov(l)
H2 <- All[-c(30,32,38,45,46,69),c(12:29)] #H2 data, remove rows with no data
H2.ord<-metaMDS(comm=H2,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
H2.ord # k2=0.066 ~7%
stressplot(H2.ord)
fit.sage.H2<- envfit(H2.ord, sage.H2,perm=1000)
fit.sage.H2   # Sig = None
Max <- H2[,c(7,9,11,13,15,17)] # H2 data Max values
Max.ord<-metaMDS(comm=Max,distance="euc",trace=FALSE, k=3,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
Max.ord # k2=0.055 ~6%
stressplot(Max.ord)
fit.sage.max<- envfit(H2.ord, sage.H2,perm=1000)
fit.sage.max   # Sig = None
Min <- H2[,c(8,10,12,14,16,18)] # H2 data Min values
Min.ord<-metaMDS(comm=Min,distance="euc",trace=FALSE, k=3,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
Min.ord # k2=0.053 ~5%
stressplot(Min.ord)
fit.sage.min<- envfit(Min.ord, sage.H2,perm=1000)
fit.sage.min   # Sig = Sig = Den (l&ld), prop ind, rel cov(l)
H2.sub <- H2[,c(1,2,3,4,5,6)] # H2 data Min values
H2.sub.ord<-metaMDS(comm=H2.sub,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
H2.sub.ord # k2=0.063 ~6%
stressplot(H2.sub.ord)
fit.sage.H2.sub<- envfit(H2.sub.ord, sage.H2,perm=1000)
fit.sage.H2.sub   # Sig = None
h2sub <- readRDS("F:/SageNMDSvariables/h2sub.Rdata")
plot(h2sub)
title(main = "NMDS Subsurface Horizon Subset Soil Variables")
plot(fit.sage.H2.sub,col="blue", cex=0.9,font=2)
Plot <- All[,c(30:42)]
Plot.ord<-metaMDS(comm=Plot,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
Plot.ord # k2=0.008 ~0.8%
stressplot(Plot.ord)
fit.sage.Plot <- envfit(Plot.ord, sage.A,perm=1000)
fit.sage.Plot    # Sig = Den (l&ld), rel cov(l&ld)
# read in data
All <- read.csv("F:/Soils/SoilEnvironmentalDataApril.csv",header=TRUE, row.names=1)
All[is.na(All)] <- 0 # replace NA with 0
All <- All[,c("H2_MinDryHue","H2_MinDryChroma","Depth100","Depth150","TotalDepth","AWC25","AWC50","AWC100")]
# add shrub environmental variables
sage.A <- read.csv("F:/SageNMDSvariables/Sage.Env.April.csv",header=TRUE,row.names=1)
sage.A[is.na(sage.A)] <- 0 # replace NA with 0
sage.H2 <- sage.A[-c(30,32,38,45,46,69),] #remove H2 empty rows.
All.ord<-metaMDS(comm=All,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
All.ord # k2=0.0018 ~0.2%
stressplot(All.ord)
fit.sage.A <- envfit(All.ord, sage.A,perm=1000)
fit.sage.A    #Sig = Den (l&ld), rel cov(l&ld)
# Soil NMDS with USGS data added to April data
data.env.NS <- read.csv("F:/Soils/SoilEnvironmentalDataNSplain.csv",header=TRUE, row.names=1)
data.env.U <- read.csv("F:/Soils/SoilEnvironmentalDataUSGSApril.csv",header=TRUE, row.names=1)
data.env.NS[is.na(data.env.NS)] <- 0 # replace NA with 0
data.env.U[is.na(data.env.U)] <- 0 # replace NA with 0
sage.NS <- read.csv("F:/SageNMDSvariables/Sage.Env.NSplainApril.csv",header=TRUE,row.names=1)
sage.U <- read.csv("F:/SageNMDSvariables/Sage.Env.USGS.csv",header=TRUE,row.names=1)
sage.NS[is.na(sage.NS)] <- 0 # replace NA with 0
sage.U[is.na(sage.U)] <- 0 # replace NA with 0
sage.H2 <- sage.U[-c(30,32,38,45,46,69,103),] #remove H2 empty rows.
All <- data.env.U[,c(1:40,42:43)] # remove SlopeShape (categorical)
All.ord<-metaMDS(comm=All,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
All.ord # k2=0.088 ~9%
stressplot(All.ord)
fit.sage.U <- envfit(All.ord, sage.U,perm=1000)
fit.sage.U    #Sig = Den (l&ld), rel cov(l&ld)
H1 <- All[,c(1:11)]
H1.ord<-metaMDS(comm=H1,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
H1.ord # k2=0.031 ~3%
stressplot(H1.ord)
fit.sage.H1 <- envfit(H1.ord, sage.U,perm=1000)
fit.sage.H1    #Sig = Den (l&ld), prop ind, rel cov(l)
H2 <- All[-c(30,32,38,45,46,69,103),c(12:29)] #H2 data, remove rows with no data
H2.ord<-metaMDS(comm=H2,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
H2.ord # k2=0.0595 ~6%
stressplot(H2.ord)
fit.sage.H2<- envfit(H2.ord, sage.H2,perm=1000)
fit.sage.H2   # Sig = None
C <- H2[,c(7:18)] # H2 data Max values
C.ord<-metaMDS(comm=C,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
C.ord # k2=0.055 ~6%
stressplot(C.ord)
fit.sage.max<- envfit(H2.ord, sage.H2,perm=1000)
fit.sage.max   # Sig = None
Max <- H2[,c(7,9,11,13,15,17)] # H2 data Max values
Max.ord<-metaMDS(comm=Max,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
Max.ord # k2=0.055 ~6%
stressplot(Max.ord)
fit.sage.max<- envfit(H2.ord, sage.H2,perm=1000)
fit.sage.max   # Sig = None
Min <- H2[,c(8,10,12,14,16,18)] # H2 data Min values
Min.ord<-metaMDS(comm=Min,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
Min.ord # k2=0.053 ~5%
stressplot(Min.ord)
fit.sage.min<- envfit(Min.ord, sage.H2,perm=1000)
fit.sage.min   # Sig = Sig = Den (l&ld), prop ind, rel cov(l)
H2.sub <- H2[,c(1,2,3,4,5,6)] # H2 data Min values
H2.sub.ord<-metaMDS(comm=H2.sub,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
H2.sub.ord # k2=0.057 ~6%
stressplot(H2.sub.ord)
fit.sage.H2.sub<- envfit(H2.sub.ord, sage.H2,perm=1000)
fit.sage.H2.sub   # Sig = None
Plot <- All[,c(30:42)]
Plot.ord<-metaMDS(comm=Plot,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
Plot.ord # k2=0.008 ~0.8%
stressplot(Plot.ord)
fit.sage.Plot <- envfit(Plot.ord, sage.U,perm=1000)
fit.sage.Plot    # Sig = Den (l&ld), rel cov(l&ld)
# read in data
All <- read.csv("F:/Soils/SoilEnvironmentalDataApril.csv",header=TRUE, row.names=1)
All[is.na(All)] <- 0 # replace NA with 0
# add shrub environmental variables
sage.A <- read.csv("F:/SageNMDSvariables/Sage.Env.April.csv",header=TRUE,row.names=1)
sage.A[is.na(sage.A)] <- 0 # replace NA with 0
sage.H2 <- sage.A[-c(30,32,38,45,46,69),] #remove H2 empty rows.
#
# All Soil Variables
#
All <- All[,c(1:40,42:43)] # remove SlopeShape (categorical)
All.ord<-metaMDS(comm=All,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
All.ord # k2=0.0285 ~3%
stressplot(All.ord)
fit.sage.A <- envfit(All.ord, sage.A,perm=1000)
fit.sage.A    #Sig = Den (l&ld), rel cov(l&ld)
orditkplot(All.ord, display="sites",choices=c(1,2), col="black", cex=0.7, pcol="gray",pch="+")
H1 <- All[,c(1:11)]
H1.ord<-metaMDS(comm=H1,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "add")
H1.ord # k2=0.0265 ~3%
stressplot(H1.ord)
fit.sage.H1 <- envfit(H1.ord, sage.A,perm=1000)
fit.sage.H1    #Sig = Den (l&ld), prop ind, rel cov(l)
orditkplot(H1.ord, display="sites",choices=c(1,2), col="black", cex=0.7, pcol="gray",pch="+")
orditkplot(H1.ord, display="sites",choices=c(1,2), col="black", cex=0.7, pcol="gray",pch="+")
ordiplot(All.ord, type ="n",main="NMDS 1&2", choices=c(1,2))
text(All.ord, display="species", col="black", cex=0.7)
plot(fit.sage.A,col="blue", cex=0.7)
ordiplot(All.ord, type ="n",main="NMDS 1&2", choices=c(1,2))
text(All.ord, display="species", col="black", cex=0.7)
text(All.ord, display="sites", col="green", cex=0.7)
plot(fit.sage.A,col="blue", cex=0.7)
ordiplot(H1.ord, type ="n",main="NMDS 1&2", choices=c(1,2))
text(H1.ord, display="species", col="black", cex=0.7)
text(H1.ord, display="sites", col="green", cex=0.7)
plot(fit.sage.A,col="blue", cex=0.7)
ordiplot(H1.ord, type ="n",main="NMDS 1&2", choices=c(1,2))
text(H1.ord, display="species", col="black", cex=0.7)
text(H1.ord, display="sites", col="green4", cex=0.7)
plot(fit.sage.A,col="blue", cex=0.7)
H2 <- All[-c(30,32,38,45,46,69),c(12:29)] #H2 data, remove rows with no data
H2.ord<-metaMDS(comm=H2,distance="euc",trace=FALSE, k=2,
autotransform = FALSE,trymax = 100, zerodist = "ignore")
H2.ord # k2=0.066 ~7%
stressplot(H2.ord)
fit.sage.H2<- envfit(H2.ord, sage.H2,perm=1000)
fit.sage.H2   # Sig = None
ordiplot(H2.ord, type ="n",main="NMDS 1&2", choices=c(1,2))
text(H2.ord, display="species", col="black", cex=0.7)
text(H2.ord, display="sites", col="green4", cex=0.7)
plot(fit.sage.H2,col="blue", cex=0.7)
orditkplot(H1.ord, display="sites",choices=c(1,2), col="black", cex=0.7, pcol="gray",pch="+")
